import { createRequire as __createRequire } from 'module';
import { fileURLToPath as __fileURLToPath } from 'url';
import path from 'path';
const require = __createRequire(import.meta.url);
const __filename = __fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);
globalThis.__filename = globalThis.__filename || __filename;
globalThis.__dirname = globalThis.__dirname || __dirname;
var Ve=Object.create;var ne=Object.defineProperty;var ze=Object.getOwnPropertyDescriptor;var Ke=Object.getOwnPropertyNames;var Fe=Object.getPrototypeOf,Ue=Object.prototype.hasOwnProperty;var G=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var re=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Pe=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Ke(t))!Ue.call(e,s)&&s!==n&&ne(e,s,{get:()=>t[s],enumerable:!(r=ze(t,s))||r.enumerable});return e};var qe=(e,t,n)=>(n=e!=null?Ve(Fe(e)):{},Pe(t||!e||!e.__esModule?ne(n,"default",{value:e,enumerable:!0}):n,e));var oe=re((Rt,We)=>{We.exports={name:"dotenv",version:"16.6.1",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard",pretest:"npm run lint && npm run dts-check",test:"tap run --allow-empty-coverage --disable-coverage --timeout=60000","test:coverage":"tap run --show-full-coverage --timeout=60000 --coverage-report=text --coverage-report=lcov",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},homepage:"https://github.com/motdotla/dotenv#readme",funding:"https://dotenvx.com",keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^18.11.3",decache:"^4.6.2",sinon:"^14.0.1",standard:"^17.0.0","standard-version":"^9.5.0",tap:"^19.2.0",typescript:"^4.8.4"},engines:{node:">=12"},browser:{fs:!1}}});var le=re((Mt,D)=>{var Q=G("fs"),H=G("path"),Ye=G("os"),Ge=G("crypto"),He=oe(),Z=He.version,Je=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function Qe(e){let t={},n=e.toString();n=n.replace(/\r\n?/mg,`
`);let r;for(;(r=Je.exec(n))!=null;){let s=r[1],o=r[2]||"";o=o.trim();let i=o[0];o=o.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),i==='"'&&(o=o.replace(/\\n/g,`
`),o=o.replace(/\\r/g,"\r")),t[s]=o}return t}function Ze(e){e=e||{};let t=ce(e);e.path=t;let n=v.configDotenv(e);if(!n.parsed){let i=new Error(`MISSING_DATA: Cannot parse ${t} for an unknown reason`);throw i.code="MISSING_DATA",i}let r=ae(e).split(","),s=r.length,o;for(let i=0;i<s;i++)try{let a=r[i].trim(),l=et(n,a);o=v.decrypt(l.ciphertext,l.key);break}catch(a){if(i+1>=s)throw a}return v.parse(o)}function Xe(e){console.log(`[dotenv@${Z}][WARN] ${e}`)}function q(e){console.log(`[dotenv@${Z}][DEBUG] ${e}`)}function ie(e){console.log(`[dotenv@${Z}] ${e}`)}function ae(e){return e&&e.DOTENV_KEY&&e.DOTENV_KEY.length>0?e.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function et(e,t){let n;try{n=new URL(t)}catch(a){if(a.code==="ERR_INVALID_URL"){let l=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw l.code="INVALID_DOTENV_KEY",l}throw a}let r=n.password;if(!r){let a=new Error("INVALID_DOTENV_KEY: Missing key part");throw a.code="INVALID_DOTENV_KEY",a}let s=n.searchParams.get("environment");if(!s){let a=new Error("INVALID_DOTENV_KEY: Missing environment part");throw a.code="INVALID_DOTENV_KEY",a}let o=`DOTENV_VAULT_${s.toUpperCase()}`,i=e.parsed[o];if(!i){let a=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${o} in your .env.vault file.`);throw a.code="NOT_FOUND_DOTENV_ENVIRONMENT",a}return{ciphertext:i,key:r}}function ce(e){let t=null;if(e&&e.path&&e.path.length>0)if(Array.isArray(e.path))for(let n of e.path)Q.existsSync(n)&&(t=n.endsWith(".vault")?n:`${n}.vault`);else t=e.path.endsWith(".vault")?e.path:`${e.path}.vault`;else t=H.resolve(process.cwd(),".env.vault");return Q.existsSync(t)?t:null}function se(e){return e[0]==="~"?H.join(Ye.homedir(),e.slice(1)):e}function tt(e){let t=!!(e&&e.debug),n=e&&"quiet"in e?e.quiet:!0;(t||!n)&&ie("Loading env from encrypted .env.vault");let r=v._parseVault(e),s=process.env;return e&&e.processEnv!=null&&(s=e.processEnv),v.populate(s,r,e),{parsed:r}}function nt(e){let t=H.resolve(process.cwd(),".env"),n="utf8",r=!!(e&&e.debug),s=e&&"quiet"in e?e.quiet:!0;e&&e.encoding?n=e.encoding:r&&q("No encoding is specified. UTF-8 is used by default");let o=[t];if(e&&e.path)if(!Array.isArray(e.path))o=[se(e.path)];else{o=[];for(let d of e.path)o.push(se(d))}let i,a={};for(let d of o)try{let u=v.parse(Q.readFileSync(d,{encoding:n}));v.populate(a,u,e)}catch(u){r&&q(`Failed to load ${d} ${u.message}`),i=u}let l=process.env;if(e&&e.processEnv!=null&&(l=e.processEnv),v.populate(l,a,e),r||!s){let d=Object.keys(a).length,u=[];for(let f of o)try{let m=H.relative(process.cwd(),f);u.push(m)}catch(m){r&&q(`Failed to load ${f} ${m.message}`),i=m}ie(`injecting env (${d}) from ${u.join(",")}`)}return i?{parsed:a,error:i}:{parsed:a}}function rt(e){if(ae(e).length===0)return v.configDotenv(e);let t=ce(e);return t?v._configVault(e):(Xe(`You set DOTENV_KEY but you are missing a .env.vault file at ${t}. Did you forget to build it?`),v.configDotenv(e))}function ot(e,t){let n=Buffer.from(t.slice(-64),"hex"),r=Buffer.from(e,"base64"),s=r.subarray(0,12),o=r.subarray(-16);r=r.subarray(12,-16);try{let i=Ge.createDecipheriv("aes-256-gcm",n,s);return i.setAuthTag(o),`${i.update(r)}${i.final()}`}catch(i){let a=i instanceof RangeError,l=i.message==="Invalid key length",d=i.message==="Unsupported state or unable to authenticate data";if(a||l){let u=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw u.code="INVALID_DOTENV_KEY",u}else if(d){let u=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw u.code="DECRYPTION_FAILED",u}else throw i}}function st(e,t,n={}){let r=!!(n&&n.debug),s=!!(n&&n.override);if(typeof t!="object"){let o=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw o.code="OBJECT_REQUIRED",o}for(let o of Object.keys(t))Object.prototype.hasOwnProperty.call(e,o)?(s===!0&&(e[o]=t[o]),r&&q(s===!0?`"${o}" is already defined and WAS overwritten`:`"${o}" is already defined and was NOT overwritten`)):e[o]=t[o]}var v={configDotenv:nt,_configVault:tt,_parseVault:Ze,config:rt,decrypt:ot,parse:Qe,populate:st};D.exports.configDotenv=v.configDotenv;D.exports._configVault=v._configVault;D.exports._parseVault=v._parseVault;D.exports.config=v.config;D.exports.decrypt=v.decrypt;D.exports.parse=v.parse;D.exports.populate=v.populate;D.exports=v});var pe=qe(le(),1);import ut from"fs";import dt from"path";import C from"process";import k from"node:process";function T(e){return typeof e=="string"&&e.trim().length>0}function B(e){return typeof e=="string"?e.trim():""}var ue=new Map(Object.entries({development:"dev",dev:"dev",production:"prod",prod:"prod",staging:"stage",stage:"stage",testing:"test",test:"test"}));function W(e){let t=B(e).toLowerCase();return t?ue.has(t)?ue.get(t):t:""}function it(){let e=B(k.env.NODE_ENV);return W(e)}function de(){if(T(k.env.STAGE_NAME)){let t=W(k.env.STAGE_NAME);if(t)return t}if(T(k.env.DEPLOYMENT_ENVIRONMENT)){let t=W(k.env.DEPLOYMENT_ENVIRONMENT);if(t)return t}let e=it();return e||"dev"}function at({stageName:e}={}){if(T(k.env.DEPLOYMENT_ENVIRONMENT)){let n=W(k.env.DEPLOYMENT_ENVIRONMENT);if(n)return n}let t=T(e)?W(e):de();return t||"dev"}function he(){return T(k.env.DATA_BUCKET)?B(k.env.DATA_BUCKET):T(k.env.S3_BUCKET)?B(k.env.S3_BUCKET):""}function ct({dataBucket:e}={}){if(T(k.env.STATIC_ASSETS_BUCKET))return B(k.env.STATIC_ASSETS_BUCKET);if(T(e))return B(e);let t=he();return t||""}function lt(){return T(k.env.LOGS_BUCKET)?B(k.env.LOGS_BUCKET):""}function R(e,t){typeof e=="string"&&T(t)&&(k.env[e]=B(t))}function me({propagateToProcessEnv:e=!0,propagateViteEnv:t=!1}={}){let n=de(),r=at({stageName:n}),s=he(),o=ct({dataBucket:s}),i=lt();return e&&(R("STAGE_NAME",n),R("DEPLOYMENT_ENVIRONMENT",r),T(s)&&R("S3_BUCKET",s),T(o)&&R("STATIC_ASSETS_BUCKET",o),T(i)&&R("LOGS_BUCKET",i)),t&&(R("VITE_STAGE_NAME",n),R("VITE_DEPLOYMENT_ENVIRONMENT",r),T(s)&&(R("VITE_S3_BUCKET",s),R("VITE_DATA_BUCKET",s)),T(o)&&R("VITE_STATIC_ASSETS_BUCKET",o),T(i)&&R("VITE_LOGS_BUCKET",i)),{stageName:n,deploymentEnvironment:r,dataBucket:s,staticAssetsBucket:o,logsBucket:i}}function $(e){return typeof e=="string"&&e.trim().length>0}var ht=$(C.env.NODE_ENV)?C.env.NODE_ENV.trim().toLowerCase():"development",mt=!!C.env.AWS_LAMBDA_FUNCTION_NAME,pt=!mt&&(ht==="development"||!$(C.env.NODE_ENV));if(pt){let e=dt.resolve(C.cwd(),".env");ut.existsSync(e)&&pe.default.config({path:e})}var fe=["S3_BUCKET","GEMINI_API_KEY"],ft=["CLOUDFRONT_ORIGINS"],X=fe.filter(e=>!$(C.env[e]));ft.forEach(e=>{$(C.env[e])||console.warn(`Optional environment value ${e} is not set. Provide it via the runtime config file or environment to enable strict CORS.`)});!$(C.env.AWS_REGION)&&$(C.env.AWS_DEFAULT_REGION)&&(C.env.AWS_REGION=C.env.AWS_DEFAULT_REGION.trim());$(C.env.AWS_REGION)||X.push("AWS_REGION");if(X.length>0)throw new Error(`Missing required environment variables: ${X.join(", ")}. Ensure they are configured via deployment secrets or a local .env file.`);var{stageName:Vt,deploymentEnvironment:zt}=me({propagateToProcessEnv:!0,propagateViteEnv:!1});var Kt=Object.freeze([...fe,"AWS_REGION"]);function ge(e={}){if(!e||typeof e.body>"u"||e.body===null)return{};if(typeof e.body=="object")return e.body;try{let t=e.isBase64Encoded?Buffer.from(e.body,"base64").toString("utf8"):e.body;return JSON.parse(t)}catch{return{}}}var gt=new Set("a,an,and,are,as,at,be,by,for,from,has,have,in,is,it,of,on,or,that,the,to,with,will,our,your,they,them,into,about,over,more,than,who,what,when,where,which,were,while,within,under,across,through,using,per".split(",").map(e=>e.trim())),ye=[{key:"layoutSearchability",category:"Layout & Searchability"},{key:"atsReadability",category:"Readability"},{key:"impact",category:"Impact"},{key:"crispness",category:"Crispness"},{key:"otherQuality",category:"Other"}];function be(e){return e>=85?"EXCELLENT":e>=70?"GOOD":"NEEDS_IMPROVEMENT"}function Y(e,t,n){return Math.min(Math.max(e,t),n)}function y(e){return Y(e,0,1)}function K(e=[],{limit:t=3,conjunction:n="and"}={}){if(!e.length)return"";let r=Array.from(new Set(e)).filter(Boolean);if(!r.length)return"";if(r.length===1)return r[0];if(r.length===2)return`${r[0]} ${n} ${r[1]}`;let s=r.slice(0,t),o=r.length-s.length;if(o>0)return`${s.join(", ")} and ${o} more`;let i=s.slice(0,-1).join(", "),a=s.slice(-1);return i?`${i} ${n} ${a}`:a.join("")}function V(e,t,n=[],r={}){let s=Y(t,0,100),o=Math.round(s),i=be(o),a=Array.from(new Set((n||[]).map(d=>typeof d=="string"?d.trim():"").filter(Boolean))),l=r&&typeof r=="object"?r.details:void 0;return a.length||(i==="EXCELLENT"?a.push(`Keep refining your ${e.toLowerCase()} as you add new achievements so the resume stays future-proof.`):a.push(`Focus on improving ${e.toLowerCase()} to raise this score\u2014tighten structure and mirror the job requirements.`)),{category:e,score:o,rating:i,ratingLabel:i,tips:a,...l?{details:l}:{}}}function yt(e,{ideal:t=.4,tolerance:n=.25}={}){if(!isFinite(e)||e<=0)return 0;let r=Math.abs(e-t);return y(1-r/n)}function bt(e,{idealMin:t=0,idealMax:n=1,tolerance:r=(n-t)/2}={}){if(!isFinite(e)||e<=0)return 0;if(e>=t&&e<=n)return 1;let s=e<t?t-e:e-n;return r<=0?0:y(1-s/r)}function vt(e,t){if(!e||typeof e!="object")return V(t,0);let n=typeof e.score=="number"?Y(e.score,0,100):0,r=Math.round(n),s=be(r),o=Array.from(new Set([].concat(typeof e.tip=="string"?e.tip:[]).concat(Array.isArray(e.tips)?e.tips:[]).map(a=>typeof a=="string"?a.trim():"").filter(Boolean))),i=V(t,r,o).tips;return{...e,category:e.category||t,score:r,rating:s,ratingLabel:s,tips:o.length?o:i}}function ee(e={}){return ye.reduce((t,{key:n,category:r})=>{let s=vt(e[n],r);return{...t,[n]:s}},{})}function ve(e={}){let t=ee(e);return ye.map(({key:n,category:r})=>{let s=t[n]||{},o=typeof s.category=="string"&&s.category.trim().length?s.category:r;return{...s,key:s.key||n,category:o}})}var Ee=["accelerated","achieved","built","delivered","developed","drove","enhanced","expanded","improved","increased","launched","led","optimized","reduced","scaled","spearheaded","streamlined"];function z(e=""){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Et(e=""){if(!e)return"";let t=e.split(/\r?\n/),n=/^[A-Z][A-Z0-9\s/&-]{2,}$/,r=/^(summary|professional summary|profile|overview)$/i,s=!1,o=[];for(let i=0;i<t.length;i+=1){let l=t[i].trim();if(!s){l&&r.test(l)&&(s=!0);continue}if(!l){o.push("");continue}if(n.test(l)&&l===l.toUpperCase()||/^(experience|work experience|employment history|education|skills|projects|certifications|awards|accomplishments)$/i.test(l))break;o.push(l.replace(/\s+/g," "))}return o.join(" ").replace(/\s+/g," ").trim()}function St(e="",{jobText:t="",jobSkills:n=[],resumeSkills:r=[]}={}){let s=e.toLowerCase(),o=(t||"").toLowerCase(),i=e.split(/\r?\n/),a=i.map(c=>c.trim()).filter(Boolean),l=e.split(/\n\s*\n/).map(c=>c.trim()).filter(Boolean),d=l.filter(c=>/^[-•\u2022\u2023\u25e6\*]/.test(c)?!1:c.split(/\s+/).filter(Boolean).length>=70),u=a.filter(c=>/^[-•\u2022\u2023\u25e6\*]/.test(c)),f=a.filter(c=>c.length>42?!1:c.replace(/[^A-Za-z]/g,"").toUpperCase().length>=4&&c===c.toUpperCase()),m=new Set(f.map(c=>c.replace(/[^a-z]/gi,"").toLowerCase())),w=a.filter(c=>c.split(/\s{3,}/).length>=2),b=a.length?u.length/a.length:0,h=u.map(c=>c.replace(/^[-•\u2022\u2023\u25e6\*]\s*/,"").split(/\s+/).filter(Boolean).length),p=[],E=[];u.forEach((c,x)=>{let P=h[x]||0;P>28&&p.push(c),P>0&&P<8&&E.push(c)});let I=h.length?h.reduce((c,x)=>c+x,0)/h.length:0,O=u.filter(c=>/\b(responsible for|duties included|tasked with)\b/i.test(c)),S=u.filter(c=>Ee.some(x=>new RegExp(`\\b${z(x)}\\b`,"i").test(c))||/[+\d%$]/.test(c)),g=new Set((n||[]).map(c=>c.toLowerCase()).filter(Boolean)),M=new Set((r||[]).map(c=>c.toLowerCase()).filter(Boolean)),A=(o.match(/[a-z0-9+.#]+/g)||[]).filter(c=>c.length>=4&&!gt.has(c)).slice(0,80),j=new Set([...g,...A]),F=Array.from(j),N=u.map(c=>{let x=F.filter(P=>new RegExp(`\\b${z(P)}\\b`,"i").test(c));return x.length?{line:c,matches:x}:null}).filter(Boolean),J=N.map(c=>c.line),_=new Set(N.flatMap(c=>c.matches.map(x=>x.toLowerCase()))).size,Ae=N.reduce((c,x)=>c+x.matches.length,0),Ce=j.size?y(_/Math.max(4,j.size)):0,Ie=_?(Ae-_)/Math.max(1,_):0,Re=y(Ie/4),Me=F.filter(c=>new RegExp(`\\b${z(c)}\\b`,"i").test(e)),U=Et(e),De=U?F.filter(c=>new RegExp(`\\b${z(c)}\\b`,"i").test(U)):[],Oe=U?Array.from(g).filter(c=>new RegExp(`\\b${z(c)}\\b`,"i").test(U)):[],te=i.length,Le=Math.max(1,Math.ceil(te/55)),Be=(e.match(/[\u2460-\u24ff\u2500-\u257f]/g)||[]).length,je=/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/i.test(e)||/\b\+?\d{1,3}[\s.-]?\(?\d{3}\)?[\s.-]?\d{3}[\s.-]?\d{4}\b/.test(e),$e=Array.from(m).some(c=>/summary|profile|overview/.test(c));return{text:e,normalizedResume:s,normalizedJobText:o,lines:a,bulletLines:u,headingLines:f,headingSet:m,multiColumnIndicators:w,bulletRatio:b,bulletWordCounts:h,avgBulletWords:I,fillerBullets:O,paragraphs:l,denseParagraphs:d,achievementLines:S,longBulletLines:p,shortBulletLines:E,normalizedJobSkills:g,normalizedResumeSkills:M,jobKeywordSet:j,bulletKeywordUniqueCount:_,bulletKeywordVariety:Ce,bulletKeywordHits:J,keywordStuffingPenalty:Re,jobKeywordMatches:Me,summaryText:U,summaryKeywordHits:De,summarySkillHits:Oe,nonAsciiCharacters:Be,hasContactInfo:je,summaryPresent:$e,rawLineCount:te,estimatedPageCount:Le}}function wt(e){let{headingLines:t,headingSet:n,bulletRatio:r,bulletLines:s,lines:o,hasContactInfo:i,denseParagraphs:a,estimatedPageCount:l,rawLineCount:d}=e,u=["experience","education","skills","summary"],f=u.filter(A=>Array.from(n).some(j=>j.includes(A))),m=y(t.length/6),w=y(f.length/u.length),b=s.length?yt(r,{ideal:.42,tolerance:.28}):0,h=i?1:0,p=a.length?Math.min(.25,a.length*.08):0,E=l>2?Math.min(.3,(l-2)*.18):0,I=d>130?Math.min(.2,(d-130)*.003):0,O=100*y(m*.23+w*.24+b*.33+h*.14-p-E-I),S=u.filter(A=>!f.includes(A)).map(A=>A.charAt(0).toUpperCase()+A.slice(1)),g=[];S.length&&g.push(`Add clear section headers for ${K(S)} so ATS bots can index your resume (only ${t.length} heading${t.length===1?"":"s"} detected).`),s.length&&b<.55&&g.push(`Adjust your bullet usage\u2014${s.length} bullet${s.length===1?"":"s"} across ${o.length} lines makes scanning harder for recruiters.`),s.length||g.push("Break dense paragraphs into bullets so scanners can pick out wins."),i||g.push("Add contact details (email or phone) so hiring teams can reach you quickly."),a.length&&g.push(`Break up ${a.length} dense paragraph${a.length===1?"":"s"} with bullet points so resume scanners do not skip your achievements.`),l>2&&g.push(`Tighten the document to two pages\u2014ATS scoring drops once resumes stretch to ${l} pages.`),d>130&&l<=2&&g.push("Trim excess line spacing or sections so the resume stays within a quick-scan length."),g.length||g.push("Your structure is solid\u2014keep the consistent headings and bullet patterns to remain searchable.");let M={headingCount:t.length,headingDensity:Number((m*100).toFixed(1)),sectionCoverage:Number((w*100).toFixed(1)),bulletCount:s.length,bulletUsageScore:Number((b*100).toFixed(1)),contactInfoPresent:!!i,contactInfoScore:h?100:0,paragraphPenalty:Math.round(p*100),pagePenalty:Math.round(E*100),lengthPenalty:Math.round(I*100),estimatedPageCount:l,rawLineCount:d};return V("Layout & Searchability",O,g,{details:M})}function Nt(e){let{normalizedResume:t,text:n,multiColumnIndicators:r,nonAsciiCharacters:s}=e,o=[],i=/\btable\b/.test(t)&&/\|/.test(n),a=t.includes("table of contents"),l=/\bpage \d+ of \d+/i.test(n),d=/https?:\/\/\S+\.(png|jpg|jpeg|gif|svg)/i.test(n),u=/[{}<>]/.test(n),f={tableLikeFormatting:i?22:0,tableOfContents:a?18:0,pageNumberFooters:l?12:0,embeddedImages:d?16:0,multiColumnSpacing:r.length>0?Math.min(5+r.length*3,20):0,decorativeCharacters:u?8:0,nonAsciiCharacters:Math.min(s*1.5,18)},m=0;Object.entries(f).forEach(([p,E])=>{E>0&&(m+=E,p==="tableLikeFormatting"&&o.push("table-like formatting"),p==="tableOfContents"&&o.push("a table of contents"),p==="pageNumberFooters"&&o.push("page number footers"),p==="embeddedImages"&&o.push("embedded images"),p==="multiColumnSpacing"&&o.push("multi-column spacing that ATS bots misread"),p==="decorativeCharacters"&&o.push("decorative characters or HTML brackets"),p==="nonAsciiCharacters"&&s>0&&o.push("non-standard symbols that confuse parsers"))});let w=Y(100-m,0,100),b=[];o.length?b.push(`Remove ${K(o)}\u2014they frequently break ATS parsing engines.`):b.push("Formatting is ATS-safe\u2014keep the clean structure as you update content."),r.length>=6&&b.push("Switch to a single-column layout so ATS parsers read left-to-right cleanly."),s>10&&b.push("Replace decorative symbols with plain text\u2014ATS parsers misread special characters.");let h={baseScore:100,penaltyTotal:Math.round(Math.min(m,100)),penaltyBreakdown:Object.fromEntries(Object.entries(f).map(([p,E])=>[p,Number(E.toFixed(2))])),multiColumnIndicators:r.length,nonAsciiCharacters:s};return V("Readability",w,b,{details:h})}function Tt(e){let{achievementLines:t,bulletLines:n,bulletKeywordHits:r,bulletKeywordUniqueCount:s,bulletKeywordVariety:o,keywordStuffingPenalty:i,jobKeywordSet:a,summaryText:l,summaryKeywordHits:d,summarySkillHits:u,normalizedJobSkills:f,normalizedResumeSkills:m}=e,w=n.length,b=w?t.length/w:0,h=y(t.length/Math.max(3,w*.6)),p=n.length?r.length/n.length:0,E=o,I=1-Math.min(.6,i*.8),O=y((p*.6+E*.4)*I),S=!!l,g=S?y(u.length/Math.max(1,Math.min(f.size,6))):0,M=S?y((d.length+g*Math.min(a.size,6))/Math.max(2,Math.min(a.size,10))):0,A=a.size?a.size-(a.size-new Set(r).size):0,j=y(A/Math.max(4,a.size)),F=100*y(b*.45+O*.22+h*.23+Math.max(M,g)*.1),N=[];if(t.length?t.length<Math.max(3,Math.ceil(n.length*.4))?N.push(`Strengthen impact statements by pairing more bullets with numbers\u2014only ${t.length} of ${n.length||"your"} bullet${t.length===1?"":"s"} include metrics or performance verbs.`):N.push("Your bullets already show strong impact\u2014keep pairing metrics with outcome-driven verbs."):N.push("Add metrics or outcome verbs (e.g., increased, reduced) to your bullets\u2014none of the bullet points currently show quantified results."),a.size>0){if(E<.3)N.push("Vary the job-aligned language\u2014repeating one keyword will not boost impact as much as weaving in a mix tied to wins.");else if(r.length<Math.max(2,Math.ceil(a.size*.1))){let L=Array.from(a).slice(0,5).map(_=>_.charAt(0).toUpperCase()+_.slice(1));L.length&&N.push(`Mirror the job posting by weaving in keywords such as ${K(L)} inside your accomplishment bullets.`)}}if(S&&u.length===0&&f.size>0&&N.push("Rework your summary to echo critical job keywords so reviewers immediately see the alignment."),i>=.4&&!N.some(L=>/vary/.test(L))&&N.push("Avoid keyword stuffing\u2014anchor achievements with varied, role-relevant language instead of repeating the same term."),m.size&&f.size){let L=Array.from(f).filter(_=>!m.has(_));L.length&&N.push(`Explicitly list ${K(L.map(_=>_.charAt(0).toUpperCase()+_.slice(1)),{limit:5})} to mirror the job posting.`)}N.length||N.push("Impact storytelling is strong\u2014keep quantifying wins as you add new roles.");let J={bulletCount:w,achievementBullets:t.length,achievementRatio:Number((b*100).toFixed(1)),achievementVolumeScore:Number((h*100).toFixed(1)),keywordLineRatio:Number((p*100).toFixed(1)),keywordVariety:Number((E*100).toFixed(1)),keywordQualityScore:Number((O*100).toFixed(1)),keywordStuffingPenalty:Number((i*100).toFixed(1)),summaryPresent:S,summaryKeywordScore:Number((M*100).toFixed(1)),summarySkillScore:Number((g*100).toFixed(1)),jobKeywordCount:a.size,bulletKeywordHits:r.length,bulletKeywordUniqueCount:s};return V("Impact",F,N,{details:J})}function kt(e){let{bulletLines:t,avgBulletWords:n,fillerBullets:r,longBulletLines:s,shortBulletLines:o}=e,i=t.filter(E=>Ee.some(I=>new RegExp(`^[-\u2022\u2022\u2023\u25E6*]?s*${z(I)}\b`,"i").test(E))),a=bt(n,{idealMin:12,idealMax:22,tolerance:10}),l=t.length?r.length/t.length:1,d=y(1-l),u=t.length?i.length/t.length:0,f=t.length?s.length/t.length:0,m=t.length?o.length/t.length:0,w=y(1-Math.min(1,f*1.1+Math.max(0,m-.3))),b=100*y(a*.3+d*.25+u*.25+w*.2),h=[];t.length||h.push("Introduce concise bullet points (12\u201320 words) so recruiters can skim quickly."),n&&n<12&&h.push(`Expand key bullets beyond ${Math.round(n)} words to explain scope and outcomes without losing clarity.`),n>22&&h.push(`Tighten lengthy bullets\u2014your average is ${Math.round(n)} words, above the ATS-friendly 18\u201322 word sweet spot.`),s.length&&h.push(`Break overly long bullets (${s.length}) into two lines so each accomplishment pops.`),o.length>Math.ceil(t.length*.4)&&h.push("Add a bit more context to ultra-short bullets so they explain the impact."),r.length&&h.push(`Replace filler openers like "responsible for" with action verbs\u2014${r.length} bullet${r.length===1?"":"s"} use passive phrasing.`),h.length||h.push("Bullet length is crisp and skimmable\u2014maintain this balance while adding fresh wins as needed.");let p={bulletCount:t.length,averageBulletWords:Number(n.toFixed(2)),lengthScore:Number((a*100).toFixed(1)),fillerBulletRatio:Number((l*100).toFixed(1)),fillerScore:Number((d*100).toFixed(1)),verbStartRatio:Number((u*100).toFixed(1)),balanceScore:Number((w*100).toFixed(1)),longBullets:s.length,shortBullets:o.length};return V("Crispness",b,h,{details:p})}function xt(e){let{normalizedJobSkills:t,normalizedResumeSkills:n,jobKeywordMatches:r,bulletKeywordVariety:s,bulletKeywordUniqueCount:o,keywordStuffingPenalty:i,summaryPresent:a,summaryKeywordHits:l,summarySkillHits:d}=e,u=t.size?n.size/Math.max(t.size,1):n.size>0?1:0,f=r.length?r.length/Math.max(t.size||r.length,6):n.size?Math.min(1,n.size/12):0,m=s;m<=0&&(m=r.length?y(r.length/Math.max(t.size||r.length,8)):0);let w=a?.2:0,b=t.size?.45:.25,h=t.size?.35:.5,p=a?y((l.length+d.length)/Math.max(2,t.size)):0,E=1-Math.min(.5,i*.7),I=y((f*.6+m*.4)*E),O=100*y(u*b+I*h+p*w),S=[];if(n.size||S.push("Add a dedicated skills section so ATS parsers can map your proficiencies."),t.size&&n.size){let M=Array.from(t).filter(A=>!n.has(A));M.length&&S.push(`Incorporate keywords such as ${K(M)} to mirror the job description.`)}a&&!l.length&&t.size&&S.push(`Infuse your summary or headline with domain language from the posting\u2014for example ${K(Array.from(t).slice(0,3))}\u2014to reinforce alignment.`),i>=.4?S.push("Swap repeated keywords for specific accomplishments\u2014ATS now favors varied, evidence-backed language."):m<.3&&r.length&&S.push("Broaden the range of JD-aligned keywords instead of repeating the same few terms."),S.length||S.push("Keyword coverage is solid\u2014keep tailoring skills to each job description.");let g={normalizedJobSkillCount:t.size,normalizedResumeSkillCount:n.size,jobKeywordMatches:r.length,skillCoverage:Number((u*100).toFixed(1)),keywordCoverageScore:Number((f*100).toFixed(1)),keywordVariety:Number((m*100).toFixed(1)),keywordQualityComposite:Number((I*100).toFixed(1)),keywordStuffingPenalty:Number((i*100).toFixed(1)),summaryContribution:Number((p*100).toFixed(1)),weights:{skillWeight:Number((b*100).toFixed(1)),keywordWeight:Number((h*100).toFixed(1)),summaryWeight:Number((w*100).toFixed(1))},summaryPresent:a,bulletKeywordUniqueCount:o};return V("Other",O,S,{details:g})}function Se(e="",{jobText:t="",jobSkills:n=[],resumeSkills:r=[]}={}){if(!e?.trim())return ee();let s=St(e,{jobText:t,jobSkills:n,resumeSkills:r}),o=wt(s),i=Nt(s),a=Tt(s),l=kt(s),d=xt(s);return ee({layoutSearchability:o,atsReadability:i,impact:a,crispness:l,otherQuality:d})}var _t=["javascript","typescript","python","java","c++","c#","go","ruby","php","swift","kotlin","react","angular","vue","node","express","next.js","docker","kubernetes","aws","gcp","azure","sql","mysql","postgresql","mongodb","git","graphql","linux","bash","redis","jenkins","terraform","ansible"],At=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");function we(e=""){let t=e.toLowerCase(),n=[];for(let r of _t)new RegExp(`\\b${At(r)}\\b`,"g").test(t)&&n.push(r);return n}function Ne(e=[],t=[]){let n=e.map(i=>{let a=t.some(l=>l.toLowerCase()===i.toLowerCase());return{skill:i,matched:a}}),r=n.filter(i=>i.matched).length,s=e.length?Math.round(r/e.length*100):0,o=n.filter(i=>!i.matched).map(i=>i.skill);return{score:s,table:n,newSkills:o}}function Te(e){let t=[],n=o=>{if(o!=null){if(Array.isArray(o)){o.forEach(i=>n(i));return}if(typeof o=="object"){Object.values(o).forEach(i=>n(i));return}typeof o=="string"&&o.split(/[\n,]/).map(i=>i.trim()).filter(Boolean).forEach(i=>t.push(i))}};n(e);let r=new Set,s=[];for(let o of t){let i=o.toLowerCase();r.has(i)||(r.add(i),s.push(o))}return s}function Ct(e={}){let t=[e.jobSkills,e.prioritySkills,e.requiredSkills,e.jobKeywords];for(let n of t){let r=Te(n);if(r.length)return r}return[]}function ke(e={}){let t=typeof e.jobId=="string"?e.jobId.trim():"";if(!t)return{ok:!1,error:{statusCode:400,code:"JOB_ID_REQUIRED",message:"jobId is required to evaluate the job description fit."}};let n=typeof e.resumeText=="string"?e.resumeText:"";if(!n.trim())return{ok:!1,error:{statusCode:400,code:"RESUME_TEXT_REQUIRED",message:"resumeText is required to evaluate the job description fit."}};let r=Ct(e);if(!r.length)return{ok:!1,error:{statusCode:400,code:"JOB_SKILLS_REQUIRED",message:"Provide jobSkills with at least one keyword to evaluate the fit."}};let s=typeof e.jobDescriptionText=="string"?e.jobDescriptionText:"",o=we(n),i=Ne(r,o),a=Se(n,{jobText:s,jobSkills:r,resumeSkills:o}),l=ve(a);return{ok:!0,result:{success:!0,jobId:t,score:i.score,missingSkills:i.newSkills,matchedSkills:i.table.filter(d=>d.matched).map(d=>d.skill),breakdown:l}}}function xe(e){if(!e||typeof e!="object")return{statusCode:500,headers:{"Content-Type":"application/json"},body:JSON.stringify({success:!1,code:"INTERNAL_ERROR",message:"Unable to evaluate job description."})};if(!e.ok){let{statusCode:t,code:n,message:r,details:s}=e.error||{};return{statusCode:t||400,headers:{"Content-Type":"application/json"},body:JSON.stringify({success:!1,code:n||"VALIDATION_ERROR",message:r||"Unable to evaluate the job description fit.",...s!==void 0?{details:s}:{}})}}return{statusCode:200,headers:{"Content-Type":"application/json"},body:JSON.stringify(e.result)}}async function _e(e,t){let n=ge(e),r=ke(n);return xe(r)}export{_e as default,_e as handler};
