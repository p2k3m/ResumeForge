[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
FAIL tests/server.test.js
  health check
    ○ skipped GET /healthz
  static asset fallbacks
    ○ skipped GET /favicon.ico returns 204
    ○ skipped serves hashed index asset from S3 when local file is missing
    ○ skipped serves hashed index asset directly from the bundled client when available
    ○ skipped strips API Gateway stage prefixes before resolving static index aliases
    ○ skipped performs HEAD lookup against S3 for hashed index asset metadata
    ○ skipped serves the latest index asset alias via S3 when local files are unavailable
    ○ skipped serves the index asset alias via the S3 manifest when the local manifest is missing
    ○ skipped serves the index asset alias when the manifest contains prefixed S3 keys
    ○ skipped serves the index asset alias via manifest fallback when the primary bundle is missing from S3
  static asset proxy endpoint
    ✕ normalizes stray punctuation in proxy asset queries
    ○ skipped serves the index alias via the local build
    ○ skipped strips inline alias annotations from hashed proxy asset queries
    ○ skipped falls back to S3 when the hashed bundle is unavailable locally
    ○ skipped degrades hashed proxy requests to the index alias when upstream assets are missing
    ○ skipped degrades direct hashed asset requests to the index alias when upstream bundles are missing
    ○ skipped rejects invalid asset paths
  static asset manifest endpoint
    ○ skipped returns manifest data when available
    ○ skipped allows forcing a manifest refresh via query parameter
    ○ skipped returns 503 when manifest is unavailable
  /api/process-cv
    ○ skipped handles DynamoDB table lifecycle
    ○ skipped removes stale session change logs when starting a new upload session
    ○ skipped removes session change log data when the session prefix is reused
    ○ skipped requires manual job description input
    ○ skipped sanitizes manual job description input before analysis
    ○ skipped rejects manual job description input containing prohibited HTML tags
    ○ skipped stores sanitized job description as session input metadata
    ○ skipped accepts uploads without a LinkedIn profile URL
    ○ skipped malformed AI response
    ○ skipped handles code-fenced JSON with extra text
    ○ skipped handles JSON surrounded by text
    ○ skipped returns presigned PDF URLs with labeled asset types
    ○ skipped returns a structured error when download URLs cannot be generated
    ○ skipped cover letter urls include structured metadata
    ○ skipped uses provided templates in preferred order
    ○ skipped uses templates array
    ○ skipped filters AI guidance lines
    ○ skipped resume prompt asks for a project matching job skills
    ○ skipped inserts project into resume text
    ○ skipped adds project section when job description provided
    ○ skipped cover letters omit placeholder sections
    ○ skipped normalizes structured cover letter responses into text
    ○ skipped uses sanitized resume fallback when AI returns plain text for versions
    ○ skipped falls back to plain PDFs when template rendering fails
    ○ skipped final CV includes updated title, project, and skills
    ○ skipped missing file
    ○ skipped unsupported file type
    ○ skipped rejects non-resume content with descriptive feedback
    ○ skipped requires re-upload when classification does not identify a CV
    ○ skipped missing job description text
    download link refresh
      ○ skipped resigns an existing artifact key for the active job
      ○ skipped returns not found when the storage key does not match the job context
    resume size handling
      ○ skipped accepts tiny PDF (32 KB) uploads up to 5 MB
      ○ skipped accepts small DOCX (256 KB) uploads up to 5 MB
      ○ skipped accepts mid-sized PDF (2 MB) uploads up to 5 MB
      ○ skipped accepts near-limit DOCX (just under 5 MB) uploads up to 5 MB
      ○ skipped rejects resumes larger than 5 MB
  /api/generate-enhanced-docs
    ○ skipped responds with structured details when jobId is missing
    ○ skipped queues message when fallback cover letters are used
    ○ skipped replaces whitespace cover letters with fallback copy
    ○ skipped audits cover letters for placeholders and applies fallback
    ○ skipped replaces weak closing cover letters with confident fallback copy
    ○ skipped replaces cover letters exceeding the word limit with confident fallback copy
    ○ skipped surfaces message when cover letters remain unavailable
    ○ skipped refreshes session artifacts when job description changes for a new enhancement
    ○ skipped refreshes session artifacts automatically when job description changes
    ○ skipped persists template vs population errors in stage metadata
  generatePdfWithFallback
    ○ skipped records retry message when 2025 renderer fails
    ○ skipped announces next template when fallback occurs for non-2025 resume
    ○ skipped announces actual next template when 2025 fallback prefers contrast option
    ○ skipped throws explicit PdfGenerationError with summary when all strategies fail
  classifyDocument
    ○ skipped identifies resumes by section structure
    ○ skipped detects cover letters
    ○ skipped rejects job descriptions that mimic resume sections
  extractText
    ○ skipped extracts text from pdf
    ○ skipped extracts text from docx
    ○ skipped guides user when pdf parsing fails
    ○ skipped guides user when docx parsing fails
    ○ skipped extracts text from doc
    ○ skipped rejects plain text files
  client download labels
    ○ skipped App displays correct labels for each file type
  change log persistence safeguards
    ○ skipped truncates oversized change log fields before persisting
    ○ skipped persists category changelog details for ATS, skills, and related sections
    ○ skipped captures rescore summary and updates session score snapshot
    ○ skipped stores session change logs under a user session prefix when no prior key exists
  change log session visibility
    ○ skipped persists reverted entries when updating the change log
    ○ skipped stores rejected entries in the session change log dismissed list
    ○ skipped persists cover letter change log payloads to S3
    ○ skipped removing a cover letter entry records dismissal state in S3
    ○ skipped persists activity logs from nested payloads into the session change log

  ● health check › GET /healthz

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset fallbacks › GET /favicon.ico returns 204

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset fallbacks › serves hashed index asset from S3 when local file is missing

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset fallbacks › serves hashed index asset directly from the bundled client when available

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset fallbacks › strips API Gateway stage prefixes before resolving static index aliases

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset fallbacks › performs HEAD lookup against S3 for hashed index asset metadata

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset fallbacks › serves the latest index asset alias via S3 when local files are unavailable

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset fallbacks › serves the index asset alias via the S3 manifest when the local manifest is missing

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset fallbacks › serves the index asset alias when the manifest contains prefixed S3 keys

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset fallbacks › serves the index asset alias via manifest fallback when the primary bundle is missing from S3

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset proxy endpoint › serves the index alias via the local build

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset proxy endpoint › normalizes stray punctuation in proxy asset queries

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset proxy endpoint › strips inline alias annotations from hashed proxy asset queries

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset proxy endpoint › falls back to S3 when the hashed bundle is unavailable locally

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset proxy endpoint › degrades hashed proxy requests to the index alias when upstream assets are missing

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset proxy endpoint › degrades direct hashed asset requests to the index alias when upstream bundles are missing

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset proxy endpoint › rejects invalid asset paths

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset manifest endpoint › returns manifest data when available

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset manifest endpoint › allows forcing a manifest refresh via query parameter

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● static asset manifest endpoint › returns 503 when manifest is unavailable

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › handles DynamoDB table lifecycle

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › removes stale session change logs when starting a new upload session

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › removes session change log data when the session prefix is reused

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › requires manual job description input

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › sanitizes manual job description input before analysis

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › rejects manual job description input containing prohibited HTML tags

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › stores sanitized job description as session input metadata

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › accepts uploads without a LinkedIn profile URL

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › malformed AI response

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › handles code-fenced JSON with extra text

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › handles JSON surrounded by text

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › returns presigned PDF URLs with labeled asset types

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › returns a structured error when download URLs cannot be generated

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › download link refresh › resigns an existing artifact key for the active job

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › download link refresh › returns not found when the storage key does not match the job context

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › cover letter urls include structured metadata

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › uses provided templates in preferred order

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › uses templates array

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › filters AI guidance lines

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › resume prompt asks for a project matching job skills

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › inserts project into resume text

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › adds project section when job description provided

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › cover letters omit placeholder sections

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › normalizes structured cover letter responses into text

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › uses sanitized resume fallback when AI returns plain text for versions

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › falls back to plain PDFs when template rendering fails

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › final CV includes updated title, project, and skills

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › missing file

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › unsupported file type

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › resume size handling › accepts tiny PDF (32 KB) uploads up to 5 MB

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › resume size handling › accepts small DOCX (256 KB) uploads up to 5 MB

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › resume size handling › accepts mid-sized PDF (2 MB) uploads up to 5 MB

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › resume size handling › accepts near-limit DOCX (just under 5 MB) uploads up to 5 MB

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › resume size handling › rejects resumes larger than 5 MB

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › rejects non-resume content with descriptive feedback

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › requires re-upload when classification does not identify a CV

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/process-cv › missing job description text

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/generate-enhanced-docs › responds with structured details when jobId is missing

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/generate-enhanced-docs › queues message when fallback cover letters are used

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/generate-enhanced-docs › replaces whitespace cover letters with fallback copy

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/generate-enhanced-docs › audits cover letters for placeholders and applies fallback

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/generate-enhanced-docs › replaces weak closing cover letters with confident fallback copy

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/generate-enhanced-docs › replaces cover letters exceeding the word limit with confident fallback copy

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/generate-enhanced-docs › surfaces message when cover letters remain unavailable

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/generate-enhanced-docs › refreshes session artifacts when job description changes for a new enhancement

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/generate-enhanced-docs › refreshes session artifacts automatically when job description changes

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● /api/generate-enhanced-docs › persists template vs population errors in stage metadata

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● generatePdfWithFallback › records retry message when 2025 renderer fails

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● generatePdfWithFallback › announces next template when fallback occurs for non-2025 resume

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● generatePdfWithFallback › announces actual next template when 2025 fallback prefers contrast option

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● generatePdfWithFallback › throws explicit PdfGenerationError with summary when all strategies fail

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● classifyDocument › identifies resumes by section structure

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● classifyDocument › detects cover letters

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● classifyDocument › rejects job descriptions that mimic resume sections

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● extractText › extracts text from pdf

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● extractText › extracts text from docx

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● extractText › guides user when pdf parsing fails

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● extractText › guides user when docx parsing fails

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● extractText › extracts text from doc

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● extractText › rejects plain text files

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● client download labels › App displays correct labels for each file type

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● change log persistence safeguards › truncates oversized change log fields before persisting

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● change log persistence safeguards › persists category changelog details for ATS, skills, and related sections

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● change log persistence safeguards › captures rescore summary and updates session score snapshot

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● change log persistence safeguards › stores session change logs under a user session prefix when no prior key exists

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● change log session visibility › persists reverted entries when updating the change log

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● change log session visibility › stores rejected entries in the session change log dismissed list

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● change log session visibility › persists cover letter change log payloads to S3

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● change log session visibility › removing a cover letter entry records dismissal state in S3

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

  ● change log session visibility › persists activity logs from nested payloads into the session change log

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    /Users/pushkarmishra/Documents/ResumeForge/ResumeForge/server.js:2
    cov_9mykhqyxi=function(){return actualCoverage;};}return actualCoverage;}cov_9mykhqyxi();import express from'express';import cors from'cors';import multer from'multer';import path from'path';import os from'os';import crypto from'crypto';import{fileURLToPath}from'url';import axios from'axios';import{EventEmitter}from'events';import{Readable}from'stream';import{pipeline as streamPipeline}from'node:stream/promises';import{S3Client,PutObjectCommand,GetObjectCommand,HeadObjectCommand,CopyObjectCommand,DeleteObjectCommand}from'@aws-sdk/client-s3';import{getSignedUrl}from'@aws-sdk/s3-request-presigner';import*as DynamoDB from'@aws-sdk/client-dynamodb';const{DynamoDBClient,CreateTableCommand,DescribeTableCommand,GetItemCommand,PutItemCommand,UpdateItemCommand,DeleteItemCommand}=/* istanbul ignore next */(cov_9mykhqyxi().s[0]++,DynamoDB);import fs from'fs/promises';import fsSync from'fs';import{spawnSync}from'node:child_process';import{logEvent,logErrorTrace}from'./logger.js';import{withBuildMetadata}from'./lib/buildMetadata.js';const stageMetadataCache=/* istanbul ignore next */(cov_9mykhqyxi().s[1]++,new Map());import{executeWithRetry,getErrorStatus,shouldRetryGeminiError,shouldRetryS3Error}from'./lib/retry.js';import Handlebars from'./lib/handlebars.js';import JSON5 from'json5';import mime from'mime-types';import{buildAggregatedChangeLogSummary}from'./client/src/utils/changeLogSummaryShared.js';import{getDeploymentEnvironment,getStageName,withEnvironmentTagging}from'./config/environment.js';import{API_ERROR_CONTRACTS,CV_GENERATION_ERROR_MESSAGE,DOWNLOAD_SESSION_EXPIRED_MESSAGE,GEMINI_ENHANCEMENT_ERROR_MESSAGE,LAMBDA_PROCESSING_ERROR_MESSAGE,S3_CHANGE_LOG_ERROR_MESSAGE,S3_STORAGE_ERROR_MESSAGE,buildServiceErrorFallbackMessages}from'./client/src/shared/serviceErrorContracts.js';import MIMEType from'whatwg-mimetype';import{renderTemplatePdf}from'./lib/pdf/index.js';import{backstopPdfTemplates as runPdfTemplateBackstop}from'./lib/pdf/backstop.js';import{parseTemplateParams as parseTemplateParamsConfig,resolveTemplateParams as resolveTemplateParamsConfig}from'./lib/pdf/utils.js';import{ENHANCEMENT_TYPES}from'./lib/resume/enhancement.js';import{extractResumeText,classifyResumeDocument,shouldRejectBasedOnClassification}from'./lib/resume/parsing.js';import{createGeminiGenerativeModel,generateContentWithRetry,parseGeminiJsonResponse}from'./lib/llm/gemini.js';import{normalizeUrl,detectLikelyLocation,extractContactDetails,parseContactLine,dedupeContactLines,filterSensitiveContactLines,buildTemplateContactContext,parseLine,normalizeHeading,ensureRequiredSections,splitSkills,moveSummaryJobEntries,mergeDuplicateSections,pruneEmptySections,normalizeName,containsContactInfo,isJobEntry,parseContent,extractExperience,extractEducation,extractCertifications}from'./lib/resume/content.js';import{publishResumeWorkflowEvent}from'./services/orchestration/eventBridgePublisher.js';import{TECHNICAL_TERMS,calculateMatchScore,computeSkillGap,extractResumeSkills,normalizeSkillListInput}from'./lib/resume/skills.js';import{evaluateJobDescription}from'./lib/resume/jobEvaluation.js';import{scoreResumeAgainstJob}from'./services/scoring/service.js';import{createTextDigest}from'./lib/resume/utils.js';import{createVersionedPrompt,PROMPT_TEMPLATES}from'./lib/llm/templates.js';import{resolveServiceForRoute}from'./microservices/services.js';import{stripUploadMetadata}from'./lib/uploads/metadata.js';import createS3StreamingStorage from'./lib/uploads/s3StreamingStorage.js';import{withRequiredLogAttributes}from'./lib/logging/attributes.js';import{notifyMissingClientAssets}from'./lib/deploy/notifications.js';import{embedCloudfrontMetadataIntoHtml,ensureMetaApiBase,resolvePublishedCloudfrontPath,updateBackupApiInputs,updateMetaApiBase}from'./lib/cloudfront/metadata.js';import{normalizeHashedIndexAssetPath,normalizeManifestHashedAssetPath}from'./lib/static/normalization.js';const knownResumeIdentifiers=/* istanbul ignore next */(cov_9mykhqyxi().s[2]++,new Set());let missingClientAssetsNotificationSent=/* istanbul ignore next */(cov_9mykhqyxi().s[3]++,false);const IMMUTABLE_STATIC_ASSET_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[4]++,'public, max-age=31536000, immutable');const STATIC_ASSET_IMMUTABLE_EXTENSION_DENYLIST=/* istanbul ignore next */(cov_9mykhqyxi().s[5]++,new Set(['.html']));const INDEX_ASSET_ALIAS_PATH_PATTERN=/* istanbul ignore next */(cov_9mykhqyxi().s[6]++,/^\/assets\/index-latest\.(css|js)$/i);const CLIENT_INDEX_CACHE_CONTROL=/* istanbul ignore next */(cov_9mykhqyxi().s[7]++,'no-cache, no-store, must-revalidate');const STATIC_PROXY_CORS_HEADER=/* istanbul ignore next */(cov_9mykhqyxi().s[8]++,'Access-Control-Allow-Origin');const STATIC_PROXY_ALIAS_METADATA_SEPARATORS=/* istanbul ignore next */(cov_9mykhqyxi().s[9]++,[',,',';;']);function applyStaticProxyCorsHeaders(res){/* istanbul ignore next */cov_9mykhqyxi().f[0]++;cov_9mykhqyxi().s[10]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[1][0]++,!res)||/* istanbul ignore next */(cov_9mykhqyxi().b[1][1]++,typeof res.setHeader!=='function')){/* istanbul ignore next */cov_9mykhqyxi().b[0][0]++;cov_9mykhqyxi().s[11]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[0][1]++;}cov_9mykhqyxi().s[12]++;try{/* istanbul ignore next */cov_9mykhqyxi().s[13]++;if(typeof res.getHeader==='function'){/* istanbul ignore next */cov_9mykhqyxi().b[2][0]++;const existing=/* istanbul ignore next */(cov_9mykhqyxi().s[14]++,res.getHeader(STATIC_PROXY_CORS_HEADER));/* istanbul ignore next */cov_9mykhqyxi().s[15]++;if(/* istanbul ignore next */(cov_9mykhqyxi().b[4][0]++,typeof existing==='string')&&/* istanbul ignore next */(cov_9mykhqyxi().b[4][1]++,existing.trim())){/* istanbul ignore next */cov_9mykhqyxi().b[3][0]++;cov_9mykhqyxi().s[16]++;return;}else/* istanbul ignore next */{cov_9mykhqyxi().b[3][1]++;}}else/* istanbul ignore next */{cov_9mykhqyxi().b[2][1]++;}}catch(error){// Ignore header inspection failures and fall back to setting the wildcard header.
                                                                                             ^^^^^^

    SyntaxError: Cannot use import statement outside a module

      140 |
      141 | beforeAll(async () => {
    > 142 |   const serverModule = await import('../server.js');
          |                        ^
      143 |   app = serverModule.default;
      144 |   extractText = serverModule.extractText;
      145 |   setGeneratePdf = serverModule.setGeneratePdf;

      at Runtime.createScriptFromCode (node_modules/jest-runtime/build/index.js:1505:14)
      at require (tests/server.test.js:142:24)
      at Object.<anonymous> (tests/server.test.js:142:24)

-------------------------------|---------|----------|---------|---------|-------------------
File                           | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
-------------------------------|---------|----------|---------|---------|-------------------
All files                      |       0 |        0 |       0 |       0 |                   
 ResumeForge                   |       0 |        0 |       0 |       0 |                   
  logger.js                    |       0 |        0 |       0 |       0 | 16-187            
  server.js                    |       0 |        0 |       0 |       0 | 30-26901          
 ResumeForge/lib               |       0 |        0 |       0 |       0 |                   
  buildMetadata.js             |       0 |        0 |       0 |       0 | 3-166             
  cloudfrontAssetCheck.js      |       0 |        0 |       0 |       0 | 3-896             
  cloudfrontAssetPrefixes.js   |       0 |        0 |       0 |       0 | 4-67              
  cloudfrontHealthCheck.js     |       0 |        0 |       0 |       0 | 4-120             
  handlebars.js                |       0 |      100 |       0 |       0 | 3-9               
  postDeploymentApiTests.js    |       0 |        0 |       0 |       0 | 4-93              
  retry.js                     |       0 |        0 |       0 |       0 | 1-172             
 ResumeForge/lib/cloudfront    |       0 |        0 |       0 |       0 |                   
  metadata.js                  |       0 |        0 |       0 |       0 | 3-217             
 ResumeForge/lib/deploy        |       0 |        0 |       0 |       0 |                   
  notifications.js             |       0 |        0 |       0 |       0 | 4-251             
 ResumeForge/lib/http          |       0 |        0 |       0 |       0 |                   
  parseEventBody.js            |       0 |        0 |       0 |       0 | 10-24             
 ResumeForge/lib/llm           |       0 |        0 |       0 |       0 |                   
  gemini.js                    |       0 |        0 |       0 |       0 | 5-254             
  templates.js                 |       0 |        0 |       0 |       0 | 1-109             
 ResumeForge/lib/logging       |       0 |        0 |       0 |       0 |                   
  attributes.js                |       0 |        0 |       0 |       0 | 2-195             
 ResumeForge/lib/observability |       0 |        0 |       0 |       0 |                   
  lambda.js                    |       0 |        0 |       0 |       0 | 7-984             
 ResumeForge/lib/pdf           |       0 |        0 |       0 |       0 |                   
  backstop.js                  |       0 |        0 |       0 |       0 | 3-169             
  index.js                     |       0 |        0 |       0 |       0 | 3-36              
  resume.js                    |       0 |        0 |       0 |       0 | 12-19             
  utils.js                     |       0 |        0 |       0 |       0 | 4-204             
 ResumeForge/lib/pdf/templates |       0 |        0 |       0 |       0 |                   
  2025.js                      |       0 |        0 |       0 |       0 | 11-1177           
 ResumeForge/lib/resume        |       0 |        0 |       0 |       0 |                   
  content.js                   |       0 |        0 |       0 |       0 | 8-1555            
  enhancement.js               |       0 |        0 |       0 |       0 | 8-445             
  jobEvaluation.js             |       0 |        0 |       0 |       0 | 9-120             
  parsing.js                   |       0 |        0 |       0 |       0 | 11-733            
  scoring.js                   |       0 |        0 |       0 |       0 | 14-819            
  skills.js                    |       0 |        0 |       0 |       0 | 8-143             
  utils.js                     |       0 |        0 |       0 |       0 | 11-18             
 ResumeForge/lib/scoring       |       0 |        0 |       0 |       0 |                   
  atsMetrics.js                |       0 |        0 |       0 |       0 | 1-956             
 ResumeForge/lib/static        |       0 |        0 |       0 |       0 |                   
  hashedIndexAssetRetention.js |       0 |        0 |       0 |       0 | 1-220             
  normalization.js             |       0 |        0 |       0 |       0 | 2-60              
 ResumeForge/lib/uploads       |       0 |        0 |       0 |       0 |                   
  metadata.js                  |       0 |        0 |       0 |       0 | 6-138             
  s3StreamingStorage.js        |       0 |        0 |       0 |       0 | 7-160             
-------------------------------|---------|----------|---------|---------|-------------------
Test Suites: 1 failed, 1 total
Tests:       1 failed, 89 skipped, 90 total
Snapshots:   0 total
Time:        17.227 s
Ran all test suites matching /tests\/server.test.js/i with tests matching "stray punctuation".
